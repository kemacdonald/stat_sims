<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Stats 60: Learning stats via simulation</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This book aims to teach statistical concepts introductory level, using both a functional and a simulation-based approach.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Stats 60: Learning stats via simulation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book aims to teach statistical concepts introductory level, using both a functional and a simulation-based approach." />
  <meta name="github-repo" content="stat_sims" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stats 60: Learning stats via simulation" />
  
  <meta name="twitter:description" content="This book aims to teach statistical concepts introductory level, using both a functional and a simulation-based approach." />
  

<meta name="author" content="Kyle MacDonald">


<meta name="date" content="2016-12-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="t-test.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stats 60: a simulation-based approach</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>2</b> Simulation</a><ul>
<li class="chapter" data-level="2.0.1" data-path="simulation.html"><a href="simulation.html#why-simulate-data"><i class="fa fa-check"></i><b>2.0.1</b> Why simulate data?</a></li>
<li class="chapter" data-level="2.0.2" data-path="simulation.html"><a href="simulation.html#setting-the-seed"><i class="fa fa-check"></i><b>2.0.2</b> Setting the seed</a></li>
<li class="chapter" data-level="2.0.3" data-path="simulation.html"><a href="simulation.html#generating-samples-from-probability-distributions"><i class="fa fa-check"></i><b>2.0.3</b> Generating samples from probability distributions</a></li>
<li class="chapter" data-level="2.0.4" data-path="simulation.html"><a href="simulation.html#dont-reapeat-yourself"><i class="fa fa-check"></i><b>2.0.4</b> Don’t reapeat yourself!</a></li>
<li class="chapter" data-level="2.0.5" data-path="simulation.html"><a href="simulation.html#repetition"><i class="fa fa-check"></i><b>2.0.5</b> Repetition</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="t-test.html"><a href="t-test.html"><i class="fa fa-check"></i><b>3</b> T-test</a><ul>
<li class="chapter" data-level="3.1" data-path="t-test.html"><a href="t-test.html#the-t-test-what-why-and-how"><i class="fa fa-check"></i><b>3.1</b> The t-test (what, why, and how)</a><ul>
<li class="chapter" data-level="3.1.1" data-path="t-test.html"><a href="t-test.html#how-do-we-use-a-t-statistic"><i class="fa fa-check"></i><b>3.1.1</b> How do we use a t-statistic?</a></li>
<li class="chapter" data-level="3.1.2" data-path="t-test.html"><a href="t-test.html#what-about-comparing-samples-from-two-different-groups"><i class="fa fa-check"></i><b>3.1.2</b> What about comparing samples from two different groups?</a></li>
<li class="chapter" data-level="3.1.3" data-path="t-test.html"><a href="t-test.html#exploring-the-normality-assumption-of-the-t-test"><i class="fa fa-check"></i><b>3.1.3</b> Exploring the normality assumption of the t-test</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stats 60: Learning stats via simulation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1">
<h1><span class="header-section-number">Chapter: 2</span> Simulation</h1>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>explain the value of simulating data and analysis in R</li>
<li>use a variety of different methods for generating your own data using R’s built-in random number generators</li>
</ul>
<div id="why-simulate-data" class="section level3">
<h3><span class="header-section-number">2.0.1</span> Why simulate data?</h3>
<p>Two major advantages for simulating data are the ability to:</p>
<ul>
<li>Test your statistical intuitions</li>
<li>Experiment with a new technique on known data</li>
</ul>
</div>
<div id="setting-the-seed" class="section level3">
<h3><span class="header-section-number">2.0.2</span> Setting the seed</h3>
<p>By design, simulations in R are generated randomly. But sometimes you want to reproduce a set of simulations. To do this, you need to use the <code>set.seed()</code> function. Compare the output of the following two code chunks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>), <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 0.0131461 5.5723942</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">45</span>)
<span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>), <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 6.022399 2.889979</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">45</span>)
<span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>), <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 6.022399 2.889979</code></pre>
</div>
<div id="generating-samples-from-probability-distributions" class="section level3">
<h3><span class="header-section-number">2.0.3</span> Generating samples from probability distributions</h3>
<p>First argument is always the number of samples to generate <code>n</code>. Then you provide the parameters of the distribution</p>
<ul>
<li><code>rnorm(n, ...)</code></li>
<li><code>rpois(n, ...)</code></li>
<li><code>rbeta(n, ...)</code></li>
<li><code>runif((n, ...))</code></li>
<li><code>rbinom((n, ...))</code></li>
</ul>
</div>
<div id="dont-reapeat-yourself" class="section level3">
<h3><span class="header-section-number">2.0.4</span> Don’t reapeat yourself!</h3>
<p>The golden rule of functional programming is “Don’t repeat yourself!” If you find yourself writing the same code more than once, then it is time to abstract and make that code into a function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_hist_plot &lt;-<span class="st"> </span>function(vect, <span class="dt">bins =</span> <span class="dv">30</span>) {
  if (<span class="kw">is.data.frame</span>(data) ==<span class="st"> </span>F) {
    data &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(vect)
  }
  
  <span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> vect), <span class="dt">data =</span> data) +
<span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> bins)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sim_hist_plot</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10000</span>, <span class="dt">m =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="dt">bins =</span> <span class="dv">100</span>)</code></pre></div>
<p><img src="bookdown-stats60_files/figure-html/unnamed-chunk-6-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
<div id="repetition" class="section level3">
<h3><span class="header-section-number">2.0.5</span> Repetition</h3>
<p>To repeat stuff, we can use the <code>replicate()</code> function, which takes two arguments:</p>
<ul>
<li><code>n</code> the number of times to do the thing</li>
<li><code>expr</code> the thing to do</li>
</ul>
<p>For example, we can write one line of code that can generate a sample (any size we choose) from a uniform distribution, take the mean of each sample, and plot those means as a histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="kw">mean</span>(<span class="kw">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">10</span>))), <span class="dt">geom=</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">bins =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="bookdown-stats60_files/figure-html/unnamed-chunk-7-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>But what if we want to do this with other types of distributions? Well, we can extend or make a more general version of this function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_means_plot &lt;-<span class="st"> </span>function(n_rep, n_samp, d, size, <span class="dt">m =</span> <span class="dv">0</span>, 
                           <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>,
                           <span class="dt">lambda =</span> <span class="dv">1</span>) {
  
  sims &lt;-<span class="st"> </span>switch(d,
         <span class="dt">normal =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> n_samp, <span class="dt">m =</span> m, <span class="dt">sd =</span> sd))),
         <span class="dt">binomial =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">rbinom</span>(<span class="dt">n =</span> n_samp, <span class="dt">size =</span> size, <span class="dt">prob =</span> prob))),
         <span class="dt">uniform =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">runif</span>(<span class="dt">n =</span> n_samp, <span class="dt">min =</span> min, <span class="dt">max =</span> max))),
         <span class="dt">poisson =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">rpois</span>(<span class="dt">n =</span> n_samp, <span class="dt">lambda =</span> lambda)))
         ) %&gt;%<span class="st">  </span>
<span class="st">    </span><span class="kw">as.data.frame</span>() 
  
  <span class="kw">names</span>(sims) &lt;-<span class="st"> &quot;value&quot;</span>
  
  <span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value), <span class="dt">data =</span> sims) +
<span class="st">    </span><span class="kw">geom_histogram</span>()
}</code></pre></div>
<p>Let’s test the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sim_means_plot</span>(<span class="dt">n_rep =</span> <span class="dv">10000</span>, <span class="dt">n_samp =</span> <span class="dv">100</span>, <span class="dt">d =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">lambda =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookdown-stats60_files/figure-html/unnamed-chunk-9-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Now that we have set up the basic tools in our simulation toolkit, we can start writing code to improve our statistical intuitions. This is the focus of the rest of this book.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="t-test.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-simulation.Rmd",
"text": "Edit"
},
"download": ["bookdown-stats60.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
