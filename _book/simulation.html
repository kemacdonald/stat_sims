<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Stats 60: Learning stats via simulation</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This book aims to teach statistical concepts at an introductory level, using a functional and simulation approach.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="Stats 60: Learning stats via simulation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book aims to teach statistical concepts at an introductory level, using a functional and simulation approach." />
  <meta name="github-repo" content="stat_sims" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stats 60: Learning stats via simulation" />
  
  <meta name="twitter:description" content="This book aims to teach statistical concepts at an introductory level, using a functional and simulation approach." />
  

<meta name="author" content="Stats 60 TAs">


<meta name="date" content="2017-01-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="descriptives.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stats 60: Learning stats via simulation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>2</b> Simulation</a><ul>
<li class="chapter" data-level="2.1" data-path="simulation.html"><a href="simulation.html#why-simulate-data"><i class="fa fa-check"></i><b>2.1</b> Why simulate data?</a></li>
<li class="chapter" data-level="2.2" data-path="simulation.html"><a href="simulation.html#setting-the-seed"><i class="fa fa-check"></i><b>2.2</b> Setting the seed</a></li>
<li class="chapter" data-level="2.3" data-path="simulation.html"><a href="simulation.html#generating-samples-from-probability-distributions"><i class="fa fa-check"></i><b>2.3</b> Generating samples from probability distributions</a></li>
<li class="chapter" data-level="2.4" data-path="simulation.html"><a href="simulation.html#repetition"><i class="fa fa-check"></i><b>2.4</b> Repetition</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>3</b> Descriptive statistics and data vizualization</a><ul>
<li class="chapter" data-level="3.1" data-path="descriptives.html"><a href="descriptives.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>3.1</b> Measures of central tendency</a><ul>
<li class="chapter" data-level="3.1.1" data-path="descriptives.html"><a href="descriptives.html#mean"><i class="fa fa-check"></i><b>3.1.1</b> Mean</a></li>
<li class="chapter" data-level="3.1.2" data-path="descriptives.html"><a href="descriptives.html#median"><i class="fa fa-check"></i><b>3.1.2</b> Median</a></li>
<li class="chapter" data-level="3.1.3" data-path="descriptives.html"><a href="descriptives.html#mode"><i class="fa fa-check"></i><b>3.1.3</b> Mode</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="descriptives.html"><a href="descriptives.html#measures-of-variability"><i class="fa fa-check"></i><b>3.2</b> Measures of variability</a><ul>
<li class="chapter" data-level="3.2.1" data-path="descriptives.html"><a href="descriptives.html#range"><i class="fa fa-check"></i><b>3.2.1</b> Range</a></li>
<li class="chapter" data-level="3.2.2" data-path="descriptives.html"><a href="descriptives.html#interquartile-range"><i class="fa fa-check"></i><b>3.2.2</b> Interquartile range</a></li>
<li class="chapter" data-level="3.2.3" data-path="descriptives.html"><a href="descriptives.html#variance"><i class="fa fa-check"></i><b>3.2.3</b> Variance</a></li>
<li class="chapter" data-level="3.2.4" data-path="descriptives.html"><a href="descriptives.html#standard-deviation"><i class="fa fa-check"></i><b>3.2.4</b> Standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="descriptives.html"><a href="descriptives.html#standard-scores"><i class="fa fa-check"></i><b>3.3</b> Standard scores</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="t-test.html"><a href="t-test.html"><i class="fa fa-check"></i><b>4</b> T-test</a><ul>
<li class="chapter" data-level="4.1" data-path="t-test.html"><a href="t-test.html#the-t-test-what-why-and-how"><i class="fa fa-check"></i><b>4.1</b> The t-test (what, why, and how)</a><ul>
<li class="chapter" data-level="4.1.1" data-path="t-test.html"><a href="t-test.html#how-to-compute-a-t-statistic"><i class="fa fa-check"></i><b>4.1.1</b> How to compute a t-statistic?</a></li>
<li class="chapter" data-level="4.1.2" data-path="t-test.html"><a href="t-test.html#how-do-we-use-a-t-statistic"><i class="fa fa-check"></i><b>4.1.2</b> How do we use a t-statistic?</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="t-test.html"><a href="t-test.html#comparing-samples-from-two-different-groups"><i class="fa fa-check"></i><b>4.2</b> Comparing samples from two different groups</a></li>
<li class="chapter" data-level="4.3" data-path="t-test.html"><a href="t-test.html#exploring-the-normality-assumption-of-the-t-test"><i class="fa fa-check"></i><b>4.3</b> Exploring the normality assumption of the t-test</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stats 60: Learning stats via simulation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation" class="section level1">
<h1><span class="header-section-number">Chapter: 2</span> Simulation</h1>
<p>By the end of this chapter, you will be able to:</p>
<ul>
<li>explain the value of simulating data and analysis in R</li>
<li>describe the goals/benefits of functional programming</li>
<li>use a variety of different methods for generating your own data using R’s built-in random number generators</li>
</ul>
<div id="why-simulate-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Why simulate data?</h2>
<p>One way to learn statistics is to TODO</p>
<p>Simulating data allows you to quickly:</p>
<ul>
<li>Test your statistical intuitions</li>
<li>Experiment with new techniques on data where you already know the answers</li>
</ul>
</div>
<div id="setting-the-seed" class="section level2">
<h2><span class="header-section-number">2.2</span> Setting the seed</h2>
<p>By design, simulations in R are generated randomly. But sometimes you want to reproduce a set of simulations to show others (or your future self) what you did. To accomplish this, you need to use the <code>set.seed()</code> function.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> Compare the output of the following two code chunks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>), <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 5.542366 8.345650</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">45</span>)
<span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>), <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 6.022399 2.889979</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">45</span>)
<span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>), <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 6.022399 2.889979</code></pre>
</div>
<div id="generating-samples-from-probability-distributions" class="section level2">
<h2><span class="header-section-number">2.3</span> Generating samples from probability distributions</h2>
<p>First argument is always the number of samples to generate <code>n</code>. Then you provide the parameters of the distribution</p>
<ul>
<li><code>rnorm(n, ...)</code></li>
<li><code>rpois(n, ...)</code></li>
<li><code>rbeta(n, ...)</code></li>
<li><code>runif((n, ...))</code></li>
<li><code>rbinom((n, ...))</code></li>
</ul>
</div>
<div id="repetition" class="section level2">
<h2><span class="header-section-number">2.4</span> Repetition</h2>
<p>Often we will want to simulate repeated draws of samples from these probability distributions. One setting is when we want to simulate an experiment with multiple participants who each complete multiple trials. In this case, if our experiment consisted of 60 trials, then each trial could be modeled as a sample from the probability distribution, e.g., <code>rnorm(n = 60, ...)</code>, but if we wanted to simulate more participants, say N = 100, then we would have to write <code>rnorm(n = 60, ...)</code> 100 times. That’s way too much typing!</p>
<p>Fortunately, R has a built-in function for repeating an expression called <code>replicate()</code>. The <code>replicate()</code> function takes two arguments:</p>
<ul>
<li><code>n</code> the number of times to repeat the expression</li>
<li><code>expr</code> the expression that we want to repeat</li>
</ul>
<p>For example, we can write one line of code that can generate a sample (any size we choose) from a uniform distribution, take the mean of each sample, and plot those means as a histogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="kw">mean</span>(<span class="kw">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">10</span>))), <span class="dt">geom=</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">bins =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="bookdown-stats60_files/figure-html/unnamed-chunk-5-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>But what if we want to do this with other types of distributions? Well, we can extend or make a more general version of this function.</p>
<p>A quick aside on functional programming. When writing code, the golden rule of functional programming is “Don’t repeat yourself!” If you find yourself writing the same thing more than once, then it is time to turn that code into a function that you can easily use again in future settings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_means_plot &lt;-<span class="st"> </span>function(n_rep, n_samp, d, size, <span class="dt">m =</span> <span class="dv">0</span>, 
                           <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>,
                           <span class="dt">lambda =</span> <span class="dv">1</span>) {
  
  sims &lt;-<span class="st"> </span>switch(d,
         <span class="dt">normal =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> n_samp, <span class="dt">m =</span> m, <span class="dt">sd =</span> sd))),
         <span class="dt">binomial =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">rbinom</span>(<span class="dt">n =</span> n_samp, <span class="dt">size =</span> size, <span class="dt">prob =</span> prob))),
         <span class="dt">uniform =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">runif</span>(<span class="dt">n =</span> n_samp, <span class="dt">min =</span> min, <span class="dt">max =</span> max))),
         <span class="dt">poisson =</span> <span class="kw">replicate</span>(n_rep, <span class="kw">mean</span>(<span class="kw">rpois</span>(<span class="dt">n =</span> n_samp, <span class="dt">lambda =</span> lambda)))
         ) %&gt;%<span class="st">  </span>
<span class="st">    </span><span class="kw">as.data.frame</span>() 
  
  <span class="kw">names</span>(sims) &lt;-<span class="st"> &quot;value&quot;</span>
  
  <span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value), <span class="dt">data =</span> sims) +
<span class="st">    </span><span class="kw">geom_histogram</span>()
}</code></pre></div>
<p>Let’s test the function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sim_means_plot</span>(<span class="dt">n_rep =</span> <span class="dv">10000</span>, <span class="dt">n_samp =</span> <span class="dv">100</span>, <span class="dt">d =</span> <span class="st">&quot;poisson&quot;</span>, <span class="dt">lambda =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="bookdown-stats60_files/figure-html/unnamed-chunk-7-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Pretty cool, right! Now we can simulate data that has been generated from a varitey of probability distributions, take the mean of that data, and visualize the distribution of those means. In statistics, this is called the <strong>sampling distribution</strong>, and is a foundational concept for hypothesis testing, which will be covered later in the book.</p>
<p>Now that we have set up the basic tools in our simulation toolkit, we can write code to improve our statistical intuitions. This is the focus of the rest of this book.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>If you are interested in the details of the set.seed() function, you can type <code>?set.seed</code> into the interpreter.<a href="simulation.html#fnref1">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="descriptives.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-simulation.Rmd",
"text": "Edit"
},
"download": ["bookdown-stats60.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
